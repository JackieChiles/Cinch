<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"> 
        <title>Cinch</title>
        
        <link rel="stylesheet" href="styles/jquery.mobile-1.1.0.min.css" />
        <link rel="stylesheet" href="styles/site.css" />
        
        <script type="text/javascript" src="scripts/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="scripts/jquery.mobile-1.1.0.min.js"></script>
        <script type="text/javascript" src="scripts/knockout-2.1.0beta.js"></script>
        <script type="text/javascript" src="scripts/modernizr-2.0.6.js"></script>
        
        <script type="text/javascript" src="scripts/cinch.main.js"></script>
        <script type="text/javascript" src="scripts/cinch.ko.js"></script>
        <script type="text/javascript" src="scripts/cinch.classes.js"></script>
        <script type="text/javascript" src="scripts/cinch.viewmodel.js"></script>
        <script type="text/javascript" src="scripts/cinch.functions.js"></script>
        <script type="text/javascript" src="scripts/cinch.animation.js"></script>
        <script type="text/javascript" src="scripts/cinch.init.js"></script>
    </head>
    
    <body>
        <div data-role="page" id="home-page">
            <div data-role="header">
                <h1>Cinch</h1>
            </div>
            <div data-role="content">
                <div id="home-buttons-container">
                    <span title="This is the name that will be displayed to other players." class="username-label">Username:</span>
                    <input data-bind="value: username" type="text" placeholder="Username" class="username" />
                    
                    <a data-role="button" data-transition="slide" href="#ai-page">New game</a>
                    <a data-role="button" data-transition="slide" href="#lobby-page">Join game</a>
                </div>
            </div>
        </div><!-- /home page -->
        
        <div data-role="page" data-title="Cinch - Lobby" id="lobby-page">
            <div data-role="header">
                <h1>Select a Game</h1>
            </div>
            <div data-role="content">
                <div data-bind="foreach: games">
                    <div class="lobby-item ui-body ui-body-b">
                        <h3>Game <span data-bind="text: number"></span></h3>
                        
                        <ul data-role="listview" data-inset="true" class="seat-list north">
                            <li data-role="list-divider">
                                <button
                                    data-bind="
                                        jqmButtonEnabled: !isOccupied()[CinchApp.playerEnum.north],
                                        click: function() { submitJoin(CinchApp.playerEnum.north) }"
                                    data-icon="arrow-r"
                                    data-iconpos="right"
                                    data-mini="true">
                                    North
                                </button>
                            </li>
                            <li data-bind="text: playerNames()[CinchApp.playerEnum.north]"></li>
                        </ul>
                            
                        <div class="east-west-seat-container">
                            <ul data-role="listview" data-inset="true" class="seat-list east-west with-south">
                                <li data-role="list-divider">
                                    <button
                                        data-bind="
                                            jqmButtonEnabled: !isOccupied()[CinchApp.playerEnum.west],
                                            click: function() { submitJoin(CinchApp.playerEnum.west) }"
                                        data-icon="arrow-r"
                                        data-iconpos="right"
                                        data-mini="true">
                                        West
                                    </button>
                                </li>
                                <li data-bind="text: playerNames()[CinchApp.playerEnum.west]"></li>
                            </ul>
                            
                            <ul data-role="listview" data-inset="true" class="seat-list east-west with-south">
                                <li data-role="list-divider">
                                    <button
                                        data-bind="
                                            jqmButtonEnabled: !isOccupied()[CinchApp.playerEnum.east],
                                            click: function() { submitJoin(CinchApp.playerEnum.east) }"
                                        data-icon="arrow-r"
                                        data-iconpos="right"
                                        data-mini="true">
                                        East
                                    </button>
                                </li>
                                <li data-bind="text: playerNames()[CinchApp.playerEnum.east]"></li>
                            </ul>
                        </div>
                        
                        <ul data-role="listview" data-inset="true" class="seat-list south">
                            <li data-role="list-divider">
                                <button
                                    data-bind="
                                        jqmButtonEnabled: !isOccupied()[CinchApp.playerEnum.south],
                                        click: function() { submitJoin(CinchApp.playerEnum.south) }"
                                    data-icon="arrow-r"
                                    data-iconpos="right"
                                    data-mini="true">
                                    South
                                </button>
                            </li>
                            <li data-bind="text: playerNames()[CinchApp.playerEnum.south]"></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div><!-- /game lobby page -->
        
        <div data-role="page" data-title="Cinch - AI Selection" id="ai-page">
            <div data-role="header">
                <h1>Select AI Agents (Optional)</h1>
            </div>
            
            <button data-bind="click: startNew">Start Game</button>
            
            <div data-role="content">
                <div>
                    <ul data-role="listview" data-inset="true" class="seat-list north">
                        <li data-role="list-divider">North </li>
                        <li class="ai-select-container">
                            <select data-bind="options: ai, optionsText: 'name', value: chosenAi[CinchApp.playerEnum.north], optionsCaption: 'Pick one'"></select>
                        </li>
                    </ul>
                        
                    <div class="east-west-seat-container">
                        <ul data-role="listview" data-inset="true" class="seat-list east-west with-south">
                            <li data-role="list-divider">West</li>
                            <li class="ai-select-container">
                                <select data-bind="options: ai, optionsText: 'name', value: chosenAi[CinchApp.playerEnum.west], optionsCaption: 'Pick one'"></select>
                            </li>
                        </ul>
                        
                        
                        <ul data-role="listview" data-inset="true" class="seat-list east-west with-south">
                            <li data-role="list-divider">East</li>
                            <li class="ai-select-container">
                                <select data-bind="options: ai, optionsText: 'name', value: chosenAi[CinchApp.playerEnum.east], optionsCaption: 'Pick one'"></select>
                            </li>
                        </ul>
                    </div>
                    
                    <ul data-role="listview" data-inset="true" class="seat-list south">
                        <li data-role="list-divider">South</li>
                        <li>You</li>
                    </ul>
                </div>
                
                <hr />
                <h2>Available agents:</h2>
            
                <div data-bind="foreach: ai" id="ai-list">
                    <ul data-role="listview" data-inset="true" class="ai">
                        <li data-bind="text: name" data-role="list-divider"></li>
                        <li>
                            <span class="label">Author</span>
                            <span data-bind="text: auth"></span>
                        </li>
                        <li>
                            <span class="label">Version</span>
                            <span data-bind="text: ver"></span>
                        </li>
                        <li>
                            <span class="label">Date</span>
                            <span data-bind="text: date"></span>
                        </li>
                        <li>
                            <span class="label">Skill</span>
                            <span data-bind="text: skl"></span>
                        </li>
                        <li>
                            <span class="label">Description</span>
                            <span data-bind="text: desc"></span>
                        </li>
                    </ul>
                </div>
            </div>
        </div><!-- /ai page -->
        
        <div data-role="page" data-title="Cinch - Bidding" id="bidding-page" class="no-close-dialog">
            <div data-role="header">
                <h1>Bidding</h1>
            </div><!-- /header -->
            
            <div data-role="content">
                <div data-bind="visible: gameMode() == CinchApp.gameModeEnum.play" class="bid-close">
                    <span>Final bids shown below.</span>
                    <button data-bind="click: endBidding">Close bid dialog</button>
                    <hr />
                </div>
            
                <ul data-role="listview" data-inset="true" data-bind="activeBorder: activePlayer() == CinchApp.playerEnum.north && gameMode() == CinchApp.gameModeEnum.bid" class="seat-list north ab-top ab-bottom ab-z">
                    <li data-bind="text: playerNames[CinchApp.playerEnum.north]" data-role="list-divider"></li>
                    <li data-bind="text: currentBidsNames()[CinchApp.playerEnum.north]"></li>
                </ul>
                    
                <div class="east-west-seat-container">
                    <ul data-role="listview" data-inset="true" data-bind="activeBorder: activePlayer() == CinchApp.playerEnum.west && gameMode() == CinchApp.gameModeEnum.bid" class="seat-list east-west ab-all ab-z">
                        <li data-bind="text: playerNames[CinchApp.playerEnum.west]" data-role="list-divider"></li>
                        <li data-bind="text: currentBidsNames()[CinchApp.playerEnum.west]"></li>
                    </ul>
                    
                    <ul data-role="listview" data-inset="true" data-bind="activeBorder: activePlayer() == CinchApp.playerEnum.east && gameMode() == CinchApp.gameModeEnum.bid" class="seat-list east-west ab-all ab-z">
                        <li data-bind="text: playerNames[CinchApp.playerEnum.east]" data-role="list-divider"></li>
                        <li data-bind="text: currentBidsNames()[CinchApp.playerEnum.east]"></li>
                    </ul>
                </div>
                    
                <hr class="clear-both"/>
                    
                <h3 class="bidding-label">Your bid</h3>
                    
                <fieldset data-role="controlgroup" data-type="horizontal" data-bind="foreach: possibleBids" id="bid-controls">
                    <button data-bind="
                        value: value,
                        text: name,
                        click: submit,
                        jqmButtonEnabled: isValid() && $root.gameMode() == CinchApp.gameModeEnum.bid,
                        activeBorder: $root.currentBids[CinchApp.playerEnum.south]() == value">
                    </button>
                </fieldset>
                    
                <hr />
                
                <h3 class="bidding-label">Your hand</h3>
                
                <div data-bind="foreach: cardsInHand" id="bid-hand">
                    <img data-bind="attr: { src: imagePath }" />
                </div>
            </div>
        </div><!-- /bidding page -->
        
        <div data-role="page" data-title="Cinch - End of Hand" id="hand-end-page" class="no-close-dialog">
            <div data-role="header">
                <h1>End of Hand</h1>
            </div><!-- /header -->
	    
            <div data-role="content">
                <div class="ui-grid-c">
                    <div class="ui-block-a">
                        <div class="ui-bar ui-bar-c">High</div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-bar ui-bar-c">Low</div>
                    </div>
                    <div class="ui-block-c">
                        <div class="ui-bar ui-bar-c">Jack</div>
                    </div>
                    <div class="ui-block-d">
                        <div class="ui-bar ui-bar-c">Game</div>
                    </div>
                    
                    <div class="ui-block-a">
                        <div data-bind="text: highTeam" class="ui-bar ui-bar-c hand-end-info"></div>
                    </div>
                    <div class="ui-block-b">
                        <div data-bind="text: lowTeam" class="ui-bar ui-bar-c hand-end-info"></div>
                    </div>
                    <div class="ui-block-c">
                        <div data-bind="text: jackTeam" class="ui-bar ui-bar-c hand-end-info"></div>
                    </div>
                    <div class="ui-block-d">
                        <div data-bind="text: gameTeam" class="ui-bar ui-bar-c hand-end-info"></div>
                    </div>
                </div>
                
                <h3 class="dialog-label">Game points</h3>
                
                <div class="ui-grid-a">
                    <div class="ui-block-a">
                        <div class="ui-bar ui-bar-c">You</div>
                    </div>
                    <div class="ui-block-b">
                        <div class="ui-bar ui-bar-c">Opponents</div>
                    </div>
                    
                    <div class="ui-block-a">
                        <div data-bind="text: gamePoints()[myTeamNum()]" class="ui-bar ui-bar-c hand-end-info"></div>
                    </div>
                    <div class="ui-block-b">
                        <!-- The 1 - myTeamNum() method with of course only work with two teams -->
                        <div data-bind="text: gamePoints()[1 - myTeamNum()]" class="ui-bar ui-bar-c hand-end-info"></div>
                    </div>
                </div>
                
                <div data-bind="visible: typeof winner() === 'undefined'">
                    <button data-bind="click: startBidding">Continue</button>
                </div>
                
                <div data-bind="visible: typeof winner() !== 'undefined'">
                    <hr />
                
                    <h3>
                        <span data-bind="text: winnerName"></span> win!
                    </h3>
                    
                    <hr />
                    
                    <h3>Final scores</h3>
                    
                    <div class="ui-grid-a">
                        <div class="ui-block-a">
                            <div class="ui-bar ui-bar-c">You</div>
                        </div>
                        <div class="ui-block-b">
                            <div class="ui-bar ui-bar-c">Opponents</div>
                        </div>
                        
                        <div class="ui-block-a">
                            <div data-bind="text: gameScores()[myTeamNum()]" class="ui-bar ui-bar-c hand-end-info"></div>
                        </div>
                        <div class="ui-block-b">
                            <div data-bind="text: gameScores()[1 - myTeamNum()]" class="ui-bar ui-bar-c hand-end-info"></div>
                        </div>
                    </div>
                    
                    <button data-bind="click: returnHome">Continue</button>
                </div>
            </div>
        </div><!-- /hand-end page -->
        
        <div data-role="page" data-title="Cinch" data-dom-cache="true" id="game-page">
            <div data-role="navbar">
                <ul>
                    <li>
                        <span class="ui-btn ui-btn-inline ui-btn-up-a">
                            <h3>Your score</h3>
                            <span data-bind="text: gameScores()[myTeamNum()]"></span>
                        </span>
                    </li>
                    <li>
                        <span class="ui-btn ui-btn-inline ui-btn-up-a">
                            <h3>Their score</h3>
                            <span data-bind="text: gameScores()[1 - myTeamNum()]"></span>
                        </span>
                    </li>
                    <li>
                        <span class="ui-btn ui-btn-inline ui-btn-up-a">
                            <h3>Winning bid</h3>
                            <span data-bind="text: highBidName"></span>
                        </span>
                    </li>
                    <li>
                        <span class="ui-btn ui-btn-inline ui-btn-up-a">
                            <h3>Trump</h3>
                            <span data-bind="text: trumpName() || '-', jqmButtomEnabled: false"></span>
                        </span>
                    </li>
                    <li>
                        <span class="ui-btn ui-btn-inline ui-btn-up-a">
                            <h3>Dealer</h3>
                            <span data-bind="text: dealerName() || '-'"></span>
                        </span>
                    </li>
                </ul>
            </div><!-- /header -->
            <div data-role="content" id="game-content">
                <div id="left-content">
                    <div id="player-2" class="other-player partner no-mobile">
                        <div data-bind="activeBorder: activePlayer() == CinchApp.playerEnum.north" class="ab-all ab-z">
                            <div data-bind="foreach: cardsInAllHands[CinchApp.playerEnum.north]" class="hand-partner">
                                <img data-bind="attr: { src: vertImagePath }" />
                            </div>
                        </div>
                    </div>
                    
                    <div id="player-1" class="other-player middle-row opponent no-mobile">
                        <div data-bind="activeBorder: activePlayer() == CinchApp.playerEnum.west" class="ab-all ab-z">
                            <div data-bind="foreach: cardsInAllHands[CinchApp.playerEnum.west]" class="hand-opponent">
                                <img data-bind="attr: { src: horizImagePath }" />
                            </div>
                        </div>
                    </div>
                    
                    <div class="middle-row">
                        <canvas id="play-surface">
                        </canvas>
                    </div>
                        
                    <div id="player-3" class="other-player middle-row opponent no-mobile">
                        <div data-bind="activeBorder: activePlayer() == CinchApp.playerEnum.east" class="ab-all ab-z">
                            <div data-bind="foreach: cardsInAllHands[CinchApp.playerEnum.east]" class="hand-opponent">
                                <img data-bind="attr: { src: horizImagePath }" />
                            </div>
                        </div>
                    </div>
                </div>
                <div id="right-content">
                    <div data-bind="visible: !isGameStarted()" id="waiting-message">
                        Waiting for other players <img src="images/loading.gif" />
                    </div>
                            
                    <input id="text-to-insert" type="text" placeholder="Enter chat message" />
                        <button id="submit-button" onclick="submitChat()">Submit Message</button>
                        <ul data-role="listview" data-inset="true" id="output-list">
                            <li data-role="list-divider">Messages</li>
                    
                            <!-- ko foreach: chats -->
                                <li data-bind="addClass: type">
                                    <strong data-bind="visible: name, text: name + ': '"></strong>
                                    <span data-bind="text: text" class="chat-message"></span>
                                </li>
                            <!-- /ko -->
                        </ul>
                </div>
                <div data-bind="foreach: cardsInHand" id="hand">
                    <div data-bind="click: submit, jqmButtonEnabled: $root.isActivePlayer() && $root.gameMode() == CinchApp.gameModeEnum.play" data-role="button" class="tile-button ui-btn ui-btn-up-c ui-shadow ui-btn-corner-all" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-theme="c">
                        <span class="ui-btn-inner ui-btn-corner-all">
                            <span class="ui-btn-text">
                                <img data-bind="attr: { src: imagePath}" />
                            </span>
                        </span>
                    </div>
                </div>
            </div>
        </div><!-- /game page -->
    </body>
</html>
